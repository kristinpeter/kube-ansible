---
# Global variables for all hosts
# Copy this file to all.yml and update the api_endpoint_name

# Kubernetes configuration
kubernetes_version: "v1.33"
kubernetes_apt_key_url: "https://pkgs.k8s.io/core:/stable:/{{ kubernetes_version }}/deb/Release.key"
kubernetes_apt_repository: "deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/{{ kubernetes_version }}/deb/ /"

# containerd configuration
containerd_version: "latest"  # Will install latest from Docker repository
docker_apt_key_url: "https://download.docker.com/linux/ubuntu/gpg"
# Architecture mapping for repositories
arch_map:
  x86_64: amd64
  aarch64: arm64
  armv7l: armhf

docker_apt_repository: "deb [arch={{ arch_map[ansible_architecture] | default('amd64') }} signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable"

# Container runtime configuration
pause_image_version: "3.10"
pause_image: "registry.k8s.io/pause:{{ pause_image_version }}"


# Network configuration - UPDATE THESE FOR YOUR ENVIRONMENT
api_endpoint_name: "api.kube.your-domain.lan"  # CHANGE THIS to your API endpoint
pod_subnet: "10.244.0.0/16"                    # Change if conflicts with your network
service_subnet: "10.96.0.0/12"                 # Change if conflicts with your network

# System configuration
disable_swap: true
configure_firewall: false  # Set to true if UFW should be configured
configure_ntp: true        # Enable NTP time synchronization (highly recommended for K8s)

# NTP Configuration
ntp_servers:
  - "0.ubuntu.pool.ntp.org"
  - "1.ubuntu.pool.ntp.org"
  - "2.ubuntu.pool.ntp.org"
  - "3.ubuntu.pool.ntp.org"
allow_ntp_clients: false   # Allow other nodes to use this as NTP server

# Required packages
common_packages:
  - apt-transport-https
  - ca-certificates
  - curl
  - gpg
  - software-properties-common

kubernetes_packages:
  - kubelet
  - kubeadm
  - kubectl

# Kernel modules required for Kubernetes
kernel_modules:
  - overlay
  - br_netfilter

# Sysctl parameters for Kubernetes
sysctl_config:
  net.bridge.bridge-nf-call-iptables: 1
  net.bridge.bridge-nf-call-ip6tables: 1
  net.ipv4.ip_forward: 1
